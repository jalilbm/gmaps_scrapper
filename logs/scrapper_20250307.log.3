2025-03-07 08:15:11,022 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:15:22,491 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:15:31,873 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:15:41,716 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:15:53,146 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:16:03,473 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:16:13,865 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:16:23,596 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:16:33,132 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:16:42,737 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:16:52,655 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:17:02,111 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:17:13,077 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:17:22,783 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:17:31,990 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:17:41,830 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:17:52,423 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:18:02,318 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:18:10,328 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:18:20,074 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:18:30,237 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:18:41,165 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:18:51,196 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:19:00,754 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:19:10,693 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:19:22,012 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:19:31,670 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:19:40,586 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:19:51,433 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:20:01,362 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:20:10,909 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:20:22,007 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:20:35,815 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:20:46,040 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:20:56,373 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:21:06,009 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:21:17,330 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:21:26,264 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:21:35,962 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:21:46,582 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:21:56,926 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:22:08,340 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:22:17,449 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:22:28,414 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:22:38,022 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:22:47,491 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:22:57,109 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:23:06,636 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:23:15,917 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:23:26,603 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:23:36,755 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:23:46,992 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:23:57,109 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:24:06,608 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:24:16,383 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:24:26,956 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:24:36,942 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:24:47,734 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:24:57,709 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:25:07,800 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:25:18,931 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:25:29,668 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:25:39,194 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:25:48,577 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:25:57,896 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:26:08,551 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:26:19,848 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:26:29,729 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:26:42,109 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:26:52,039 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:27:01,844 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:27:13,199 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:27:23,347 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:27:33,304 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:27:43,654 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:27:54,583 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:28:04,104 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:28:16,518 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:28:25,213 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:28:34,842 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:28:44,202 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:28:53,430 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:29:02,923 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:29:13,245 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:29:23,113 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:29:32,622 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:29:42,602 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:29:52,525 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
