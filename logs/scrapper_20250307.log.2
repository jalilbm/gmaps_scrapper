2025-03-07 08:30:02,775 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:30:13,568 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:30:23,067 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:30:32,498 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:30:42,311 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:30:52,567 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:31:02,614 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:31:12,650 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:31:23,172 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:31:36,360 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:31:46,350 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:31:56,670 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:32:05,122 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:32:16,278 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:32:26,952 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:32:36,534 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:32:46,378 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:32:56,359 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:33:07,685 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:33:18,468 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:33:30,880 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:33:40,956 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:33:51,393 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:00,440 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:10,729 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:20,537 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:29,809 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:38,150 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:47,496 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:34:59,189 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:35:10,091 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:35:21,745 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:35:31,155 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:35:41,598 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:35:51,815 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:36:02,718 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:36:13,642 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:36:25,253 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:36:36,981 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:36:48,247 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:36:58,092 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:37:06,836 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:37:17,643 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:37:27,055 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:37:36,970 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:37:48,237 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:37:57,928 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:38:07,652 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:38:17,632 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:38:27,584 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:38:37,654 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:38:47,255 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:38:57,444 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:39:06,970 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:39:16,594 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:39:26,765 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:39:36,273 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:39:46,586 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:39:56,760 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:40:06,062 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:40:17,177 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:40:27,202 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:40:37,134 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:40:48,023 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:40:57,965 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:41:07,328 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:41:17,382 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:41:28,771 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:41:39,122 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:41:51,087 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:42:01,871 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:42:11,658 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:42:22,947 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:42:32,905 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:42:42,321 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:42:51,748 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:43:01,714 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:43:11,558 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:43:21,432 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:43:31,327 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:43:41,961 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:43:53,346 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:44:03,130 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:44:14,550 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:44:23,155 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:44:33,922 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:44:44,693 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:44:54,054 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
