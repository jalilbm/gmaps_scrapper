2025-03-07 08:59:46,858 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:59:58,302 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:00:10,692 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:00:20,722 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:00:30,187 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:00:39,760 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:00:49,212 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:00:59,010 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:01:10,410 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:01:22,364 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:01:32,964 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:01:43,958 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:01:54,051 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:02:05,019 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 09:02:15,858 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 19:32:13,724 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 19:32:13,725 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 19:32:14,340 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 19:32:14,341 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 19:32:14,341 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 19:32:14,343 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:37:28,150 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:37:28,150 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:37:28,296 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:37:28,296 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:37:28,297 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:37:28,299 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:38:45,923 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:38:45,924 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:38:46,039 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:38:46,040 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:38:46,040 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:38:46,046 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:39:20,373 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:39:20,373 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:39:20,485 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:39:20,486 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:39:20,486 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:39:20,489 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:39:58,144 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:39:58,144 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:39:58,254 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:39:58,254 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:39:58,254 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:39:58,255 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:41:09,129 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:41:09,130 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:41:09,239 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:41:09,239 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:41:09,239 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:41:09,240 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:54:42,798 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:54:42,799 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:54:42,999 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:54:42,999 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:54:42,999 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:54:43,001 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:55:18,353 - google_maps_scraper - INFO - Initialized 4 web drivers
2025-03-07 20:55:18,397 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 1
2025-03-07 20:55:18,414 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 2
2025-03-07 20:55:18,426 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 3
2025-03-07 20:55:18,426 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:19,428 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:20,429 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:21,430 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:22,431 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:23,432 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:24,433 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:25,434 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:26,435 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:55:26,914 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x113775e10>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56430): Max retries exceeded with url: /session/c9960d0a01e353b31d0069c5328a8e38/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x113775e10>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:55:26,915 - GoogleMaps - WARNING - Timeout waiting for selector: [style='position: relative;'][tabindex='-1'] [tabindex='-1']
2025-03-07 20:55:27,079 - GoogleMaps - WARNING - Timeout waiting for selector: [tabindex='-1'] [role='main'][aria-label] h1
2025-03-07 20:55:27,079 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 296, in scroll_all_places_in_list
    raise (NoSuchWindowException)
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:55:27,076 - google_maps_scraper - ERROR - Browser window error for driver 1 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x113775e10>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56430): Max retries exceeded with url: /session/c9960d0a01e353b31d0069c5328a8e38/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x113775e10>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:55:27,079 - google_maps_scraper - ERROR - Browser window error for driver 2 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 296, in scroll_all_places_in_list
    raise (NoSuchWindowException)
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:55:27,220 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1137779b0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56646): Max retries exceeded with url: /session/2a6c380538a4383a9d13e1e472219172/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1137779b0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x11710c270>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56646): Max retries exceeded with url: /session/2a6c380538a4383a9d13e1e472219172/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x11710c270>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:55:27,225 - google_maps_scraper - ERROR - Browser window error for driver 3 - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1137779b0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56646): Max retries exceeded with url: /session/2a6c380538a4383a9d13e1e472219172/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1137779b0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x11710c270>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=56646): Max retries exceeded with url: /session/2a6c380538a4383a9d13e1e472219172/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x11710c270>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:55:35,352 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:55:35,352 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:55:35,446 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:55:35,446 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:55:35,446 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:55:35,451 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:56:25,465 - google_maps_scraper - INFO - Initialized 4 web drivers
2025-03-07 20:56:25,516 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 1
2025-03-07 20:56:25,538 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 2
2025-03-07 20:56:25,556 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 3
2025-03-07 20:56:25,556 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:26,557 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:27,558 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:28,559 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:29,560 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:30,561 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:31,561 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:56:32,351 - GoogleMaps - ERROR - Unexpected error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
                             " response")
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 310, in scroll_all_places_in_list
    self.driver.execute_script(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        f"arguments[0].scrollTop += {scroll}", places_list
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
                             " response")
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-03-07 20:56:32,477 - GoogleMaps - WARNING - Timeout waiting for selector: [style='position: relative;'][tabindex='-1'] [tabindex='-1']
2025-03-07 20:56:32,487 - GoogleMaps - WARNING - Timeout waiting for selector: [tabindex='-1'] [role='main'][aria-label] h1
2025-03-07 20:56:32,487 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 296, in scroll_all_places_in_list
    raise (NoSuchWindowException)
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:56:32,488 - google_maps_scraper - ERROR - Browser window error for driver 2 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 296, in scroll_all_places_in_list
    raise (NoSuchWindowException)
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:56:32,602 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10fd77680>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57029): Max retries exceeded with url: /session/7f1e48860f7374ab42ef88a115fa749a/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10fd77680>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x119a20050>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57029): Max retries exceeded with url: /session/7f1e48860f7374ab42ef88a115fa749a/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x119a20050>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:56:32,608 - google_maps_scraper - ERROR - Browser window error for driver 1 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10fd77680>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57029): Max retries exceeded with url: /session/7f1e48860f7374ab42ef88a115fa749a/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10fd77680>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x119a20050>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57029): Max retries exceeded with url: /session/7f1e48860f7374ab42ef88a115fa749a/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x119a20050>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:56:32,715 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x119a209e0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57270): Max retries exceeded with url: /session/afcd4083ae3527217596404b5657e270/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x119a209e0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10fd76cf0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57270): Max retries exceeded with url: /session/afcd4083ae3527217596404b5657e270/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10fd76cf0>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:56:32,719 - google_maps_scraper - ERROR - Browser window error for driver 3 - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x119a209e0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57270): Max retries exceeded with url: /session/afcd4083ae3527217596404b5657e270/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x119a209e0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10fd76cf0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57270): Max retries exceeded with url: /session/afcd4083ae3527217596404b5657e270/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10fd76cf0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:57:21,878 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 20:57:21,878 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 20:57:22,013 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 20:57:22,013 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 20:57:22,014 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 20:57:22,015 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 20:58:09,407 - google_maps_scraper - INFO - Initialized 4 web drivers
2025-03-07 20:58:09,460 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 1
2025-03-07 20:58:09,488 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 2
2025-03-07 20:58:09,510 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 3
2025-03-07 20:58:09,510 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:10,510 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:11,512 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:12,513 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:13,513 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:14,514 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:15,515 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:16,516 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:17,517 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:18,517 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:19,518 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:20,520 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:21,521 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:22,523 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:23,524 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:24,525 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:25,526 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:26,527 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:27,529 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:28,530 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:29,531 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:30,532 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:31,534 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:32,534 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:33,535 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:34,535 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:35,536 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:36,537 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:37,538 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:38,539 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 20:58:39,356 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdd040>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58104): Max retries exceeded with url: /session/85093ff4b5d15591bda232938844f475/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdd040>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcddd00>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58104): Max retries exceeded with url: /session/85093ff4b5d15591bda232938844f475/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcddd00>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:58:39,369 - google_maps_scraper - ERROR - Browser window error for driver 2 - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdd040>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58104): Max retries exceeded with url: /session/85093ff4b5d15591bda232938844f475/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdd040>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcddd00>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58104): Max retries exceeded with url: /session/85093ff4b5d15591bda232938844f475/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcddd00>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:58:39,461 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcde9c0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57964): Max retries exceeded with url: /session/30d7d860586bf18503a185616a24a54a/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcde9c0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdfce0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57964): Max retries exceeded with url: /session/30d7d860586bf18503a185616a24a54a/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdfce0>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:58:39,462 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdebe0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58248): Max retries exceeded with url: /session/72826ff13cea47febc290ae01e52d98e/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdebe0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdff00>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58248): Max retries exceeded with url: /session/72826ff13cea47febc290ae01e52d98e/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdff00>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 20:58:39,465 - google_maps_scraper - ERROR - Browser window error for driver 1 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcde9c0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57964): Max retries exceeded with url: /session/30d7d860586bf18503a185616a24a54a/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcde9c0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdfce0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=57964): Max retries exceeded with url: /session/30d7d860586bf18503a185616a24a54a/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdfce0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 20:58:39,471 - google_maps_scraper - ERROR - Browser window error for driver 3 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdebe0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58248): Max retries exceeded with url: /session/72826ff13cea47febc290ae01e52d98e/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdebe0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x10dcdff00>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58248): Max retries exceeded with url: /session/72826ff13cea47febc290ae01e52d98e/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x10dcdff00>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:00:48,718 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:00:48,718 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:00:48,840 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:00:48,840 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:00:48,841 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:00:48,841 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:01:53,396 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:01:53,396 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:01:53,527 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:01:53,527 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:01:53,528 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:01:53,529 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:02:40,496 - google_maps_scraper - INFO - Initialized 4 web drivers
2025-03-07 21:02:40,581 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 1
2025-03-07 21:02:40,611 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 2
2025-03-07 21:02:40,640 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 3
2025-03-07 21:02:40,640 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:02:41,640 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:02:42,641 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:02:43,642 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:02:44,643 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:02:45,645 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:02:46,381 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b5590>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=59944): Max retries exceeded with url: /session/01ba2fa42338cb70074a26ec51448099/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b5590>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 21:02:46,419 - google_maps_scraper - ERROR - Browser window error for driver 1 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 292, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/socket.py", line 719, in readinto
    return self._sock.recv_into(b)
           ~~~~~~~~~~~~~~~~~~~~^^^
urllib3.exceptions.ProtocolError: ('Connection aborted.', ConnectionResetError(54, 'Connection reset by peer'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b5590>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=59944): Max retries exceeded with url: /session/01ba2fa42338cb70074a26ec51448099/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b5590>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:02:46,640 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b5e10>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60074): Max retries exceeded with url: /session/741a462b7e54275ae3975f612c2ef6f0/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b5e10>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b67a0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60074): Max retries exceeded with url: /session/741a462b7e54275ae3975f612c2ef6f0/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b67a0>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 21:02:46,644 - google_maps_scraper - ERROR - Browser window error for driver 2 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b5e10>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60074): Max retries exceeded with url: /session/741a462b7e54275ae3975f612c2ef6f0/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b5e10>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b67a0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60074): Max retries exceeded with url: /session/741a462b7e54275ae3975f612c2ef6f0/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b67a0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:02:46,655 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b7130>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60202): Max retries exceeded with url: /session/91b8bca643eb989d0904a2a62aec5ec4/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b7130>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b79b0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60202): Max retries exceeded with url: /session/91b8bca643eb989d0904a2a62aec5ec4/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b79b0>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 21:02:46,660 - google_maps_scraper - ERROR - Browser window error for driver 3 - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b7130>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60202): Max retries exceeded with url: /session/91b8bca643eb989d0904a2a62aec5ec4/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b7130>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1230b79b0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60202): Max retries exceeded with url: /session/91b8bca643eb989d0904a2a62aec5ec4/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1230b79b0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:35:03,757 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:35:03,757 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:35:03,870 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:35:03,870 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:35:03,871 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:35:03,872 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:36:04,662 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:36:04,662 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:36:04,771 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:36:04,771 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:36:04,772 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:36:04,773 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:37:23,312 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:37:23,314 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:37:23,590 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:37:23,590 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:37:23,590 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:37:23,592 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:38:31,594 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:38:31,595 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:38:31,715 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:38:31,715 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:38:31,716 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:38:31,717 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:39:17,782 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:39:17,783 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:39:17,982 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:39:17,982 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:39:17,982 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:39:17,983 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:39:56,550 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:39:56,550 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:39:56,657 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:39:56,657 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:39:56,658 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:39:56,659 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:40:46,726 - google_maps_scraper - INFO - Initialized 4 web drivers
2025-03-07 21:40:46,782 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 1
2025-03-07 21:40:46,820 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 2
2025-03-07 21:40:46,855 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 3
2025-03-07 21:40:46,855 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:47,856 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:48,857 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:49,858 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:50,859 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:51,860 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:52,862 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:53,871 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:54,873 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:55,874 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:56,875 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:40:57,512 - GoogleMaps - WARNING - Timeout waiting for selector: [style='position: relative;'][tabindex='-1'] [tabindex='-1']
2025-03-07 21:40:57,516 - GoogleMaps - WARNING - Timeout waiting for selector: [tabindex='-1'] [role='main'][aria-label] h1
2025-03-07 21:40:57,517 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 296, in scroll_all_places_in_list
    raise (NoSuchWindowException)
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:40:57,518 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1127da030>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58715): Max retries exceeded with url: /session/3d713a0667a0740f92b58da732039e07/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1127da030>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1127db460>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58715): Max retries exceeded with url: /session/3d713a0667a0740f92b58da732039e07/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1127db460>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 21:40:57,857 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1127dbac0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58977): Max retries exceeded with url: /session/30b8d57b90fa7b7517ed7ebeb0e83907/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1127dbac0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x113ed8490>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=58977): Max retries exceeded with url: /session/30b8d57b90fa7b7517ed7ebeb0e83907/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x113ed8490>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 21:41:04,742 - google_maps_scraper - INFO - Starting Google Maps scraper
2025-03-07 21:41:04,742 - google_maps_scraper - INFO - Target location: dubai
2025-03-07 21:41:04,791 - google_maps_scraper - INFO - Search keyword: clinics
2025-03-07 21:41:04,791 - google_maps_scraper - INFO - Non-allowed categories: ['pharmacy']
2025-03-07 21:41:04,792 - google_maps_scraper - INFO - Generated 3 search URLs
2025-03-07 21:41:04,793 - google_maps_scraper - DEBUG - Loaded selectors configuration
2025-03-07 21:41:51,853 - google_maps_scraper - INFO - Initialized 4 web drivers
2025-03-07 21:41:51,928 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 1
2025-03-07 21:41:51,966 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 2
2025-03-07 21:41:52,002 - google_maps_scraper - DEBUG - Submitted scraping task for URL with driver 3
2025-03-07 21:41:52,002 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:53,004 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:54,006 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:55,007 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:56,009 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:57,010 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:58,011 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:41:59,013 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:00,014 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:00,306 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
0   undetected_chromedriver             0x0000000104c43922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x0000000104c3b5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000104717dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x000000010476bb69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x000000010476bf51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x00000001047bb664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x0000000104792c0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x00000001047b863a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x00000001047929b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x000000010475cec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x000000010475dda1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x0000000104c0bd40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x0000000104c0e773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x0000000104c0e2eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x0000000104c0ebd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x0000000104bf0cef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x0000000104c0eebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x0000000104be18f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x0000000104c2b4f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x0000000104c2b6be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x0000000104c3b1b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.StaleElementReferenceException: Message: stale element reference: stale element not found
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#stale-element-reference-exception
Stacktrace:
0   undetected_chromedriver             0x0000000104c43922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x0000000104c3b5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000104717dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x000000010472c0ef undetected_chromedriver + 504047
4   undetected_chromedriver             0x000000010472ae19 undetected_chromedriver + 499225
5   undetected_chromedriver             0x000000010471fb2c undetected_chromedriver + 453420
6   undetected_chromedriver             0x000000010471fc5c undetected_chromedriver + 453724
7   undetected_chromedriver             0x000000010471dc49 undetected_chromedriver + 445513
8   undetected_chromedriver             0x0000000104721d4c undetected_chromedriver + 462156
9   undetected_chromedriver             0x00000001047b9775 undetected_chromedriver + 1083253
10  undetected_chromedriver             0x0000000104792be2 undetected_chromedriver + 924642
11  undetected_chromedriver             0x00000001047b863a undetected_chromedriver + 1078842
12  undetected_chromedriver             0x00000001047929b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x000000010475cec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x000000010475dda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x0000000104c0bd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x0000000104c0e773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x0000000104c0e2eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x0000000104c0ebd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x0000000104bf0cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x0000000104c0eebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x0000000104be18f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x0000000104c2b4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x0000000104c2b6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x0000000104c3b1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15

2025-03-07 21:42:01,015 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:02,017 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:03,018 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:04,020 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:05,022 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:06,023 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:07,025 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:08,026 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:09,027 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:10,028 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:11,030 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:12,031 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:13,032 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:14,033 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:15,034 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:16,036 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:17,038 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:18,039 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:19,040 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:20,041 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:21,042 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:22,044 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:23,045 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:24,047 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:25,049 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:26,050 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:27,052 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:28,053 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:29,054 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:30,055 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:31,056 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:32,058 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:33,059 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:34,060 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:35,061 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:36,062 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:36,347 - GoogleMaps - INFO - All places divs: 122
2025-03-07 21:42:36,348 - GoogleMaps - INFO - URLS:[0/3]-LIST:[1/122]-DONE:[0]
2025-03-07 21:42:36,476 - GoogleMaps - INFO - Processing place - Title: Royal Phoenix Clinic Wasl Village, Address: wasl village Retail Center - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1 - data: {'title': 'Royal Phoenix Clinic Wasl Village', 'address': 'wasl village Retail Center'}
2025-03-07 21:42:37,063 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:38,064 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:39,065 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:39,208 - GoogleMaps - INFO - Skipping duplicate place - Title: Royal Phoenix Clinic Wasl Village, Address: wasl village Retail Center - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1 - data: {'title': 'Royal Phoenix Clinic Wasl Village', 'address': 'wasl village Retail Center'}
2025-03-07 21:42:39,261 - GoogleMaps - INFO - URLS:[0/3]-LIST:[2/122]-DONE:[0]
2025-03-07 21:42:39,291 - GoogleMaps - INFO - Processing place - Title: Best Health Medical Center (Poly Clinic), Address: 42nd St - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1 - data: {'title': 'Best Health Medical Center (Poly Clinic)', 'address': '42nd St'}
2025-03-07 21:42:40,066 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:40,139 - GoogleMaps - INFO - All places divs: 122
2025-03-07 21:42:40,139 - GoogleMaps - INFO - URLS:[0/3]-LIST:[1/122]-DONE:[0]
2025-03-07 21:42:40,220 - GoogleMaps - INFO - Processing place - Title: Aster Clinic, Al Quoz - Al Khail Mall, Address: Al Khail Mall - First Floor - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1 - data: {'title': 'Aster Clinic, Al Quoz - Al Khail Mall', 'address': 'Al Khail Mall - First Floor'}
2025-03-07 21:42:41,067 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:41,169 - GoogleMaps - INFO - Fetching 8566 reviews
2025-03-07 21:42:41,174 - GoogleMaps - WARNING - Retrying to click reviews tab for the 0 time
2025-03-07 21:42:42,027 - GoogleMaps - INFO - Skipping duplicate place - Title: Best Health Medical Center (Poly Clinic), Address: 42nd St - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1 - data: {'title': 'Best Health Medical Center (Poly Clinic)', 'address': '42nd St'}
2025-03-07 21:42:42,069 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:42,082 - GoogleMaps - INFO - URLS:[0/3]-LIST:[3/122]-DONE:[0]
2025-03-07 21:42:42,107 - GoogleMaps - INFO - Processing place - Title: ARIN CARE Clinic & Pharmacy, Address: Shop # 5 Talal Plaza Mall - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1 - data: {'title': 'ARIN CARE Clinic & Pharmacy', 'address': 'Shop # 5 Talal Plaza Mall'}
2025-03-07 21:42:43,070 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:43,711 - GoogleMaps - INFO - Fetching 166 reviews
2025-03-07 21:42:43,716 - GoogleMaps - WARNING - Retrying to click reviews tab for the 0 time
2025-03-07 21:42:44,071 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:44,230 - GoogleMaps - WARNING - Retrying to click reviews tab for the 1 time
2025-03-07 21:42:44,746 - GoogleMaps - WARNING - Retrying to click reviews tab for the 2 time
2025-03-07 21:42:45,073 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:46,074 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:47,075 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:48,077 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:48,939 - GoogleMaps - WARNING - Browser session error while get_data_from_place for the 0 time - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
2025-03-07 21:42:48,940 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 870, in get_place_reviews
    self.sort_reviews_by_time()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 713, in sort_reviews_by_time
    reviews_newest_sort_option = self.driver.find_element(
        by=By.CSS_SELECTOR, value=reviews_newest_sort_option_css_selector
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":"[role='menuitemradio'][data-index='1']"}
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   undetected_chromedriver             0x000000010269c922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x00000001026945ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000102170dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x00000001021c4b69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x00000001021c4f51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x0000000102214664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x00000001021ebc0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x000000010221163a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x00000001021eb9b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x00000001021b5ec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x00000001021b6da1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x0000000102664d40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x0000000102667773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x00000001026672eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x0000000102667bd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x0000000102649cef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x0000000102667ebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x000000010263a8f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x00000001026844f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x00000001026846be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x00000001026941b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None

2025-03-07 21:42:49,077 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:50,078 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:51,079 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:52,080 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:53,081 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:54,083 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:55,084 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:56,085 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:56,844 - GoogleMaps - WARNING - Timeout waiting for selector: [tabindex='-1'] [role='main'][aria-label] div[data-review-id][jsaction*='review.in']
2025-03-07 21:42:57,086 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:58,089 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:42:59,091 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:00,092 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:01,093 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:02,094 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:03,096 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:04,097 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:05,099 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:05,719 - GoogleMaps - INFO - Successfully fetched 3 reviews
2025-03-07 21:43:05,833 - GoogleMaps - INFO - Successfully scraped place data - url: https://www.google.com/maps/place/Aster+Clinic,+Al+Quoz+-+Al+Khail+Mall/@25.1450388,55.2436334,15z/data=!4m10!1m2!2m1!1sclinics!3m6!1s0x3e5f695bfbadf613:0xb5b4454e33e87312!8m2!3d25.1491849!4d55.2462495!15sCgdjbGluaWNzWgkiB2NsaW5pY3OSAQ5tZWRpY2FsX2NlbnRlcuABAA!16s%2Fg%2F11byp83rwz?entry=ttu&g_ep=EgoyMDI1MDMwNC4wIKXMDSoASAFQAw%3D%3D - data: {'title': 'Aster Clinic, Al Quoz - Al Khail Mall', 'category': 'Medical Center'}
2025-03-07 21:43:05,833 - GoogleMaps - INFO - URLS:[0/3]-LIST:[2/122]-DONE:[1]
2025-03-07 21:43:05,919 - GoogleMaps - INFO - Processing place - Title: Syed Sadiq Clinic, Address: Latifa Bint Hamdan St - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1 - data: {'title': 'Syed Sadiq Clinic', 'address': 'Latifa Bint Hamdan St'}
2025-03-07 21:43:06,100 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:06,815 - GoogleMaps - INFO - Fetching 54 reviews
2025-03-07 21:43:06,819 - GoogleMaps - WARNING - Retrying to click reviews tab for the 0 time
2025-03-07 21:43:07,101 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:07,333 - GoogleMaps - WARNING - Retrying to click reviews tab for the 1 time
2025-03-07 21:43:07,845 - GoogleMaps - WARNING - Retrying to click reviews tab for the 2 time
2025-03-07 21:43:08,102 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:08,373 - GoogleMaps - WARNING - Retrying to click reviews tab for the 3 time
2025-03-07 21:43:09,103 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:10,105 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:11,011 - GoogleMaps - WARNING - Browser session error while get_data_from_place for the 0 time - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
2025-03-07 21:43:11,012 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 870, in get_place_reviews
    self.sort_reviews_by_time()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 699, in sort_reviews_by_time
    reviews_sort_button = self.driver.find_element(
        by=By.CSS_SELECTOR, value=reviews_sort_button_css_selector
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":"[tabindex='-1'] [role='main'][aria-label] [data-value='Sort']"}
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   undetected_chromedriver             0x000000010340d922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x00000001034055ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000102ee1dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x0000000102f35b69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x0000000102f35f51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x0000000102f85664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x0000000102f5cc0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x0000000102f8263a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x0000000102f5c9b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x0000000102f26ec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x0000000102f27da1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x00000001033d5d40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x00000001033d8773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x00000001033d82eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x00000001033d8bd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x00000001033bacef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x00000001033d8ebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x00000001033ab8f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x00000001033f54f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x00000001033f56be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x00000001034051b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None

2025-03-07 21:43:11,105 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:12,106 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:13,108 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:14,110 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:15,111 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:16,113 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:17,113 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:18,115 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:19,116 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:20,119 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:21,121 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:22,122 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:23,124 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:24,125 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:25,127 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:26,129 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:27,130 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:28,131 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:29,132 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:30,134 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:31,136 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:32,137 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:33,138 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:34,140 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:35,142 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:36,143 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:37,144 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:38,145 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:39,147 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:40,149 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:40,349 - google_maps_scraper - ERROR - Browser window error for driver 1 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 146, in until
    raise TimeoutException(message, screen, stacktrace)
selenium.common.exceptions.TimeoutException: Message: 
Stacktrace:
0   undetected_chromedriver             0x0000000104c43922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x0000000104c3b5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000104717dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x000000010476bb69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x000000010476bf51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x00000001047bb664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x0000000104792c0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x00000001047b863a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x00000001047929b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x000000010475cec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x000000010475dda1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x0000000104c0bd40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x0000000104c0e773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x0000000104c0e2eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x0000000104c0ebd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x0000000104bf0cef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x0000000104c0eebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x0000000104be18f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x0000000104c2b4f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x0000000104c2b6be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x0000000104c3b1b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.StaleElementReferenceException: Message: stale element reference: stale element not found
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#stale-element-reference-exception
Stacktrace:
0   undetected_chromedriver             0x0000000104c43922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x0000000104c3b5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000104717dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x000000010472c0ef undetected_chromedriver + 504047
4   undetected_chromedriver             0x000000010472ae19 undetected_chromedriver + 499225
5   undetected_chromedriver             0x000000010471fb2c undetected_chromedriver + 453420
6   undetected_chromedriver             0x000000010471fc5c undetected_chromedriver + 453724
7   undetected_chromedriver             0x000000010471dc49 undetected_chromedriver + 445513
8   undetected_chromedriver             0x0000000104721d4c undetected_chromedriver + 462156
9   undetected_chromedriver             0x00000001047b9775 undetected_chromedriver + 1083253
10  undetected_chromedriver             0x0000000104792be2 undetected_chromedriver + 924642
11  undetected_chromedriver             0x00000001047b863a undetected_chromedriver + 1078842
12  undetected_chromedriver             0x00000001047929b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x000000010475cec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x000000010475dda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x0000000104c0bd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x0000000104c0e773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x0000000104c0e2eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x0000000104c0ebd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x0000000104bf0cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x0000000104c0eebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x0000000104be18f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x0000000104c2b4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x0000000104c2b6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x0000000104c3b1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:43:41,150 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:42,151 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:43,151 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:44,153 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:45,154 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:46,155 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:47,156 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:48,158 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:49,159 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:50,160 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:51,161 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:52,161 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:53,163 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:54,164 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:55,165 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:56,167 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:57,170 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:58,171 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:43:59,172 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:00,173 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:01,174 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:02,175 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:03,177 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:04,179 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:05,181 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:06,184 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:07,185 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:08,186 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:09,188 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:10,189 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:11,189 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:12,190 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:13,192 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:14,193 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:15,194 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:16,195 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:17,196 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:18,197 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:19,198 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:20,199 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:21,200 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:22,202 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:23,203 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:24,205 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:25,205 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:26,207 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:27,208 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:28,209 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:28,947 - google_maps_scraper - ERROR - Browser window error for driver 3 - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 870, in get_place_reviews
    self.sort_reviews_by_time()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 713, in sort_reviews_by_time
    reviews_newest_sort_option = self.driver.find_element(
        by=By.CSS_SELECTOR, value=reviews_newest_sort_option_css_selector
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":"[role='menuitemradio'][data-index='1']"}
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   undetected_chromedriver             0x000000010269c922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x00000001026945ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000102170dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x00000001021c4b69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x00000001021c4f51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x0000000102214664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x00000001021ebc0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x000000010221163a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x00000001021eb9b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x00000001021b5ec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x00000001021b6da1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x0000000102664d40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x0000000102667773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x00000001026672eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x0000000102667bd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x0000000102649cef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x0000000102667ebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x000000010263a8f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x00000001026844f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x00000001026846be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x00000001026941b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:44:29,211 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:30,212 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:31,213 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:32,214 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:33,215 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:34,216 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:35,217 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:36,218 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:37,220 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:38,222 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:39,223 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:40,225 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:41,225 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:41,575 - GoogleMaps - INFO - All places divs: 122
2025-03-07 21:44:41,575 - GoogleMaps - INFO - URLS:[0/3]-LIST:[1/122]-DONE:[1]
2025-03-07 21:44:41,677 - GoogleMaps - INFO - Skipping duplicate place - Title: Royal Phoenix Clinic Wasl Village, Address: wasl village Retail Center - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1 - data: {'title': 'Royal Phoenix Clinic Wasl Village', 'address': 'wasl village Retail Center'}
2025-03-07 21:44:41,732 - GoogleMaps - INFO - URLS:[0/3]-LIST:[2/122]-DONE:[1]
2025-03-07 21:44:41,754 - GoogleMaps - INFO - Skipping duplicate place - Title: Best Health Medical Center (Poly Clinic), Address: 42nd St - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1 - data: {'title': 'Best Health Medical Center (Poly Clinic)', 'address': '42nd St'}
2025-03-07 21:44:41,808 - GoogleMaps - INFO - URLS:[0/3]-LIST:[3/122]-DONE:[1]
2025-03-07 21:44:41,832 - GoogleMaps - INFO - Processing place - Title: ARIN CARE Clinic & Pharmacy, Address: Shop # 5 Talal Plaza Mall - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1 - data: {'title': 'ARIN CARE Clinic & Pharmacy', 'address': 'Shop # 5 Talal Plaza Mall'}
2025-03-07 21:44:42,226 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:43,227 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:43,416 - GoogleMaps - INFO - Fetching 166 reviews
2025-03-07 21:44:44,229 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:45,230 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:46,232 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:47,233 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:48,234 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:49,235 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:50,236 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:51,018 - google_maps_scraper - ERROR - Browser window error for driver 2 - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 870, in get_place_reviews
    self.sort_reviews_by_time()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 699, in sort_reviews_by_time
    reviews_sort_button = self.driver.find_element(
        by=By.CSS_SELECTOR, value=reviews_sort_button_css_selector
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":"[tabindex='-1'] [role='main'][aria-label] [data-value='Sort']"}
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   undetected_chromedriver             0x000000010340d922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x00000001034055ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000102ee1dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x0000000102f35b69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x0000000102f35f51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x0000000102f85664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x0000000102f5cc0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x0000000102f8263a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x0000000102f5c9b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x0000000102f26ec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x0000000102f27da1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x00000001033d5d40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x00000001033d8773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x00000001033d82eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x00000001033d8bd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x00000001033bacef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x00000001033d8ebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x00000001033ab8f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x00000001033f54f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x00000001033f56be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x00000001034051b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None

2025-03-07 21:44:51,237 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:52,238 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:53,239 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:54,240 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:55,241 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:56,243 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:57,244 - google_maps_scraper - DEBUG - Waiting for 3 active tasks to complete
2025-03-07 21:44:57,570 - google_maps_scraper - ERROR - Error while restarting driver 2: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')) - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 870, in get_place_reviews
    self.sort_reviews_by_time()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 699, in sort_reviews_by_time
    reviews_sort_button = self.driver.find_element(
        by=By.CSS_SELECTOR, value=reviews_sort_button_css_selector
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":"[tabindex='-1'] [role='main'][aria-label] [data-value='Sort']"}
  (Session info: chrome=134.0.6998.45); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#no-such-element-exception
Stacktrace:
0   undetected_chromedriver             0x000000010340d922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x00000001034055ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000102ee1dfe undetected_chromedriver + 421374
3   undetected_chromedriver             0x0000000102f35b69 undetected_chromedriver + 764777
4   undetected_chromedriver             0x0000000102f35f51 undetected_chromedriver + 765777
5   undetected_chromedriver             0x0000000102f85664 undetected_chromedriver + 1091172
6   undetected_chromedriver             0x0000000102f5cc0d undetected_chromedriver + 924685
7   undetected_chromedriver             0x0000000102f8263a undetected_chromedriver + 1078842
8   undetected_chromedriver             0x0000000102f5c9b3 undetected_chromedriver + 924083
9   undetected_chromedriver             0x0000000102f26ec3 undetected_chromedriver + 704195
10  undetected_chromedriver             0x0000000102f27da1 undetected_chromedriver + 708001
11  undetected_chromedriver             0x00000001033d5d40 undetected_chromedriver + 5614912
12  undetected_chromedriver             0x00000001033d8773 undetected_chromedriver + 5625715
13  undetected_chromedriver             0x00000001033d82eb undetected_chromedriver + 5624555
14  undetected_chromedriver             0x00000001033d8bd5 undetected_chromedriver + 5626837
15  undetected_chromedriver             0x00000001033bacef undetected_chromedriver + 5504239
16  undetected_chromedriver             0x00000001033d8ebc undetected_chromedriver + 5627580
17  undetected_chromedriver             0x00000001033ab8f4 undetected_chromedriver + 5441780
18  undetected_chromedriver             0x00000001033f54f8 undetected_chromedriver + 5743864
19  undetected_chromedriver             0x00000001033f56be undetected_chromedriver + 5744318
20  undetected_chromedriver             0x00000001034051b8 undetected_chromedriver + 5808568
21  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
22  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
                             " response")
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    driver = web_driver.get_driver(driver_id)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/utils/web_driver.py", line 33, in get_driver
    driver.set_window_size(window_width, window_height)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 1031, in set_window_size
    self.set_window_rect(width=int(width), height=int(height))
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 1111, in set_window_rect
    return self.execute(Command.SET_WINDOW_RECT, {"x": x, "y": y, "width": width, "height": height})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 516, in getresponse
    httplib_response = super().getresponse()
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1428, in getresponse
    response.begin()
    ~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
                             " response")
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-03-07 21:44:57,907 - GoogleMaps - WARNING - Timeout waiting for selector: [tabindex='-1'] [role='main'][aria-label] div[data-review-id][jsaction*='review.in']
2025-03-07 21:44:57,909 - GoogleMaps - WARNING - Timeout waiting for selector: [tabindex='-1'] [role='main'][aria-label] [tabindex='-1'][jslog*='mutable:true']
2025-03-07 21:44:57,912 - GoogleMaps - ERROR - Error processing place: HTTPConnectionPool(host='localhost', port=60533): Max retries exceeded with url: /session/289d053b22a3b421da3102d9ad4d4dc9/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x111cec6b0>: Failed to establish a new connection: [Errno 61] Connection refused')) - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165929,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x111cec6b0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 794, in scroll_all_reviews
    reviews_list = self.driver.find_element(
        by=By.CSS_SELECTOR, value=all_reviews_css_selector
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60533): Max retries exceeded with url: /session/289d053b22a3b421da3102d9ad4d4dc9/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x111cec6b0>: Failed to establish a new connection: [Errno 61] Connection refused'))
2025-03-07 21:44:57,965 - GoogleMaps - ERROR - Browser session error while scrap_data_from_search_url - url: https://www.google.com/maps/search/clinics/@25.2908331,55.4165928,16z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x111cecf30>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 316, in scroll_all_places_in_list
    if WebDriverWait(self.driver, 0.1).until(
       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.presence_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        )
        ^
    ):
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 110, in _predicate
    return driver.find_element(*locator)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 898, in find_element
    return self.execute(Command.FIND_ELEMENT, {"using": by, "value": value})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60851): Max retries exceeded with url: /session/98fd8a87bdd2c8f5ac31ba9398d2b619/element (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x111cecf30>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
        (self._dns_host, self.port),
    ...<2 lines>...
        socket_options=self.socket_options,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
    ~~~~~~~~~~~~^^^^
ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
        conn,
    ...<10 lines>...
        **response_kw,
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 493, in _make_request
    conn.request(
    ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<6 lines>...
        enforce_content_length=enforce_content_length,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 445, in request
    self.endheaders()
    ~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1091, in _send_output
    self.send(msg)
    ~~~~~~~~~^^^^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/http/client.py", line 1035, in send
    self.connect()
    ~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 276, in connect
    self.sock = self._new_conn()
                ~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connection.py", line 213, in _new_conn
    raise NewConnectionError(
        self, f"Failed to establish a new connection: {e}"
    ) from e
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x1105839b0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 250, in scrap_data_from_search_url
    result = self.scroll_all_places_in_list()
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 336, in scroll_all_places_in_list
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", places_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 427, in execute
    response = self.command_executor.execute(driver_command, params)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 404, in execute
    return self._request(command_info[0], url, body=data)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/remote_connection.py", line 428, in _request
    response = self._conn.request(method, url, body=body, headers=headers, timeout=self._client_config.timeout)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 143, in request
    return self.request_encode_body(
           ~~~~~~~~~~~~~~~~~~~~~~~~^
        method, url, fields=fields, headers=headers, **urlopen_kw
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/_request_methods.py", line 278, in request_encode_body
    return self.urlopen(method, url, **extra_kw)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/poolmanager.py", line 443, in urlopen
    response = conn.urlopen(method, u.request_uri, **kw)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 871, in urlopen
    return self.urlopen(
           ~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...<13 lines>...
        **response_kw,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/connectionpool.py", line 841, in urlopen
    retries = retries.increment(
        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/urllib3/util/retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=60851): Max retries exceeded with url: /session/98fd8a87bdd2c8f5ac31ba9398d2b619/execute/sync (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x1105839b0>: Failed to establish a new connection: [Errno 61] Connection refused'))
