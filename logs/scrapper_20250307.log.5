2025-03-07 07:45:34,557 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:45:45,217 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:45:53,872 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:46:04,006 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:46:14,666 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:46:25,191 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:46:35,062 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:46:45,180 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:46:54,377 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:47:03,603 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:47:14,110 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:47:23,409 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:47:32,811 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:47:43,568 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:47:55,568 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:48:03,520 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:48:12,484 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:48:22,450 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:48:32,730 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:48:41,966 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:48:51,283 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:49:00,995 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:49:10,680 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:49:21,675 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:49:31,975 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:49:42,020 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:49:52,123 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:50:01,563 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:50:10,481 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:50:20,924 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:50:30,792 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:50:40,619 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:50:51,730 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:51:02,714 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:51:14,229 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:51:27,462 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:51:36,931 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:51:46,871 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:51:58,035 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:52:08,916 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:52:18,452 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:52:28,583 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:52:38,489 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:52:48,821 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:52:59,545 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:53:09,717 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:53:20,158 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:53:29,952 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:53:39,941 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:53:49,349 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:53:58,893 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:54:08,432 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:54:17,693 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:54:27,080 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:54:37,030 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:54:46,881 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:54:56,688 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:55:06,102 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:55:16,727 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:55:26,965 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:55:37,325 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:55:46,767 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:55:56,311 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:56:05,775 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:56:15,746 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:56:26,530 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:56:37,939 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:56:48,900 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:56:59,015 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:57:09,102 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:57:20,279 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:57:29,707 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:57:39,099 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:57:50,802 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:58:01,104 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:58:11,148 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:58:21,432 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:58:31,576 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:58:41,570 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:58:50,974 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:59:01,955 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:59:11,985 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:59:22,056 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:59:33,584 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:59:43,819 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 07:59:53,443 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:00:03,672 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
2025-03-07 08:00:12,816 - google_maps_scraper - ERROR - Error while restarting driver 1: cannot schedule new futures after shutdown - url: https://www.google.com/maps/search/clinics/@25.1450395,55.2436334,15z/data=!3m1!4b1
Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 810, in scroll_all_reviews
    WebDriverWait(self.driver, 0.1).until(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        EC.invisibility_of_element_located(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            (By.CSS_SELECTOR, loading_spin_css_selector)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        )
        ^
    )
    ^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/wait.py", line 137, in until
    value = method(self._driver)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 564, in _predicate
    return _element_if_visible(target, visibility=False)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/support/expected_conditions.py", line 280, in _element_if_visible
    return element if element.is_displayed() == visibility else False
                      ~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webelement.py", line 340, in is_displayed
    return self.parent.execute_script(f"/* isDisplayed */return ({isDisplayed_js}).apply(null, arguments);", self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee1bfd undetected_chromedriver + 322557
4   undetected_chromedriver             0x0000000100ee0d4d undetected_chromedriver + 318797
5   undetected_chromedriver             0x0000000100ee0819 undetected_chromedriver + 317465
6   undetected_chromedriver             0x0000000100ee0519 undetected_chromedriver + 316697
7   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
8   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
9   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
10  undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
11  undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
12  undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
13  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
14  undetected_chromedriver             0x0000000100f9a958 undetected_chromedriver + 1079640
15  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
16  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
17  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
18  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
19  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
20  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
21  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
22  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
23  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
24  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
25  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
26  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
27  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
28  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
29  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1030, in get_data_from_place
    reviews = self.get_place_reviews(number_of_reviews)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 871, in get_place_reviews
    self.scroll_all_reviews(number_of_reviews)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 825, in scroll_all_reviews
    current_height = self.driver.execute_script(
        "return arguments[0].scrollHeight", reviews_list
    )
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 528, in execute_script
    return self.execute(command, {"script": script, "args": converted_args})["value"]
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/webdriver.py", line 429, in execute
    self.error_handler.check_response(response)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/venv/lib/python3.13/site-packages/selenium/webdriver/remote/errorhandler.py", line 232, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: tab crashed
  (Session info: chrome=134.0.6998.45)
Stacktrace:
0   undetected_chromedriver             0x0000000101425922 undetected_chromedriver + 5843234
1   undetected_chromedriver             0x000000010141d5ea undetected_chromedriver + 5809642
2   undetected_chromedriver             0x0000000100ef9b73 undetected_chromedriver + 420723
3   undetected_chromedriver             0x0000000100ee04cf undetected_chromedriver + 316623
4   undetected_chromedriver             0x0000000100ede3cf undetected_chromedriver + 308175
5   undetected_chromedriver             0x0000000100eded94 undetected_chromedriver + 310676
6   undetected_chromedriver             0x0000000100eee4b0 undetected_chromedriver + 373936
7   undetected_chromedriver             0x0000000100f08d42 undetected_chromedriver + 482626
8   undetected_chromedriver             0x0000000100f0f5fb undetected_chromedriver + 509435
9   undetected_chromedriver             0x0000000100edf480 undetected_chromedriver + 312448
10  undetected_chromedriver             0x0000000100f0841c undetected_chromedriver + 480284
11  undetected_chromedriver             0x0000000100f9a533 undetected_chromedriver + 1078579
12  undetected_chromedriver             0x0000000100f749b3 undetected_chromedriver + 924083
13  undetected_chromedriver             0x0000000100f3eec3 undetected_chromedriver + 704195
14  undetected_chromedriver             0x0000000100f3fda1 undetected_chromedriver + 708001
15  undetected_chromedriver             0x00000001013edd40 undetected_chromedriver + 5614912
16  undetected_chromedriver             0x00000001013f0773 undetected_chromedriver + 5625715
17  undetected_chromedriver             0x00000001013f02eb undetected_chromedriver + 5624555
18  undetected_chromedriver             0x00000001013f0bd5 undetected_chromedriver + 5626837
19  undetected_chromedriver             0x00000001013d2cef undetected_chromedriver + 5504239
20  undetected_chromedriver             0x00000001013f0ebc undetected_chromedriver + 5627580
21  undetected_chromedriver             0x00000001013c38f4 undetected_chromedriver + 5441780
22  undetected_chromedriver             0x000000010140d4f8 undetected_chromedriver + 5743864
23  undetected_chromedriver             0x000000010140d6be undetected_chromedriver + 5744318
24  undetected_chromedriver             0x000000010141d1b8 undetected_chromedriver + 5808568
25  libsystem_pthread.dylib             0x00007ff813cb018b _pthread_start + 99
26  libsystem_pthread.dylib             0x00007ff813cabae3 thread_start + 15


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 261, in scrap_data_from_search_url
    self.get_data_from_place(place_div=place_div)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1064, in get_data_from_place
    raise InvalidSessionIdException
selenium.common.exceptions.InvalidSessionIdException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1176, in task_complete
    future.result()  # This will re-raise any exception that occurred during the task execution.
    ~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 271, in scrap_data_from_search_url
    raise NoSuchWindowException
selenium.common.exceptions.NoSuchWindowException: Message: None


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/macbook/PycharmProjects/google_maps_scraper/google_maps_scraper.py", line 1188, in task_complete
    retry_future = executor.submit(
        google_maps_instance.scrap_data_from_search_url
    )
  File "/opt/homebrew/Cellar/python@3.13/3.13.1/Frameworks/Python.framework/Versions/3.13/lib/python3.13/concurrent/futures/thread.py", line 171, in submit
    raise RuntimeError('cannot schedule new futures after shutdown')
RuntimeError: cannot schedule new futures after shutdown
